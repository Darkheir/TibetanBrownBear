"""Detail the Yeti's Malware object structure."""

from marshmallow import fields

from yeti.core.errors import ValidationError
from .entity import Entity, EntitySchema


class MalwareSchema(EntitySchema):
    """(De)serialization marshmallow.Schema for Malware objects."""
    family = fields.List(fields.String(), allow_none=True)


class Malware(Entity):
    """Malware Yeti object.

    Attributes:
      family: list(str), the families this malware belongs to.
    """

    schema = MalwareSchema
    _collection_name = 'entities'

    type = 'entity.malware'
    family = []

    def is_valid(self):
        Entity.is_valid(self)
        if not isinstance(self.family, list):
            raise ValidationError('.family must be a list of strings.')
        return True

Entity.datatypes[Malware.type] = Malware
